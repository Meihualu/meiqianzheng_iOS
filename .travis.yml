language: objective-c
cache: bundler
before_script:
- openssl aes-256-cbc -k "$ENCRYPTION_SECRET" -in scripts/certs/dist.cer.enc -d -a
  -out scripts/certs/dist.cer
- openssl aes-256-cbc -k "$ENCRYPTION_SECRET" -in scripts/certs/dist.p12.enc -d -a
  -out scripts/certs/dist.p12
- openssl aes-256-cbc -k "$ENCRYPTION_SECRET" -in scripts/profile/MeiQianZheng.mobileprovision.enc
  -d -a -out scripts/profile/MeiQianZheng.mobileprovision
- ./scripts/add-key.sh
- ./scripts/update-bundle.sh
script:
- xctool -workspace MeiQianZheng/MeiQianZheng.xcworkspace -scheme MeiQianZheng -sdk iphoneos -configuration Release OBJROOT=$PWD/build SYMROOT=$PWD/build ONLY_ACTIVE_ARCH=NO PGYER_APP_KEY=$PGYER_APP_KEY
- xctool test -workspace MeiQianZheng/MeiQianZheng.xcworkspace -scheme MeiQianZhengTests -sdk iphonesimulator
  ONLY_ACTIVE_ARCH=NO
after_script:
- ./scripts/remove-key.sh
after_success:
- ./scripts/sign-and-upload.sh
env:
  global:
  - secure: pzHWXQS/NJTvJXJR/WNCSeORVRKfPF1ILOV8g6Hf7tBcvZvL25KF72pdJ3DvhZDMEj8WlCSYdeEQwZO7lDdO0U0I8LIN18c9S4v0pqnaIaVF8hDlV+0EeKvYqa5G9qG9u34ribbKlyAajWivYhuTLizqn4FloNnYOE2tUcAoloKTMw+k3yEOU0v+gfzr9ElZPA6E9F+5soBn8nrGgQccC8pTPR5C8U3kM8dTTilQ/doxpvCNSMCuVLttJ+DMAxLlqMenoUhBZ+seO4oI36hN05PjxkttxE12g7aSxiUqxyRAG8Zg9BALLSUaZ3xK4qhs7ijJo0aYaVVWhvz8CUErVoEBLLVe2evyGUQw1JRvN1axCAKqO3x9uLJnHGtlpOdBg4Qx+8XpNNEZaJcIlpWfgDnIBkawfMi2eN0WBMzWQ0yDHrkm3jqTZrCZtfHSAnE0YbWqIDF1hW2Fl4w7ullZvmp2QOKNvJb2MAuCTMMhtY/S/ufx1uEmrlN58bbK0818N+wrJkRng0ZfoIeESSyAfvdkXzSVbOgwH8IF8dVyKdpzUQNVTAFoq4PoNEHZ0kjZtrmfwNxcAKyz7zEaPMvIpSkOr7oV/lY/TAAmGdmrnC83Nw/SvjGFt38fOFX7AGAA28n6nWjHOCVqA7CgP6zcaXjum/JuYy+h3AnK8G+rRDI=
  - secure: EH/kTWIqCpy9ZKyw4P8XauJxW50eiqNTpbbsFA+yaIfTQq6mz8YRAyukwqUBAs3F5db17lvkEWD0Bgi/xP5WX6KLzQuRZIJNr/+xVNDQ4J00x2TAP/H9giUtUWY6eAnpcZLQhAHj7f8AeGwguvgsxJ3JCX8yzjP2OKkwTIohlQmcAuoUwkGm8hO6SDJBhIJDnX3Xw8BcWYSXBLHdDwPVK4/gd1j7+C6sqaQapZO5QdHGpQcK67AU6fGIbwnyjg2Jm4XqVTO72OCFFFSOonwVe2f8jVuTgFxxOBmN0+pQb/2fsrrjHESxdSn2N75oUPCm5e7cacyQHvHivLa40KUNuloIXi4ASNHlGaTrDTNnO9UHF9NTR4gk/VDuToelJfw+laT6Xlu651V4rS19C+4iF93iVoELJl3jDKOiGZTWzjNpwBpkHHUW7d+CPhesxZ+X5ORcvY1PzChdxY+cFPVGoHrvR6b0gHPyo8xk/pjKHbbX8S4vPOhGC6dfoTPYJSBtX4tDenO11+0U/xYx+neZvdB9K86jgitJ/GeTemtPpmVkVNwiuKcs3Lnu1EttQCiM5JRNXJExdsZtKV/jVNen9CAv3vjj92casb3ShO7r37C+SsbTaxSCBfa2kRPFFB1rRmyygqz3o45q3pP7v+IzmaJN2IJGD1pPofx4RAd+oXQ=
  - secure: d1TipsFSjzYHqSSbiy+YbPm1+RYcM/hXzv9sD9SELzpZ01BDYldYWuHko7aeBG2SS1F4wd+8ZvMSwL1xiVC0xwSxKSDZRCwBti/m42Vm8uenOtGHyweLSksvbNI33hraMHjbpGzw2/LO9qt0aBBEBMuIQAqL4gY02q/z7C961bb7qyIS+eMwlepctvzxH1q9ZVZNwjTYt59akWVtJzyDvj0jb8jh2OTRUAhkPDDSXKzvPWbsLkpt6UvXzOIt1kk1VF0XfqmWjLK+dUCOLdmXFM2t3H2ilNQAIFhTUaAfhQhaUfraXnT8BNqGIec6Gv6WXuAw/Y/NtFC8V8kg5k8c8hp+Hu0hpTX5MDURGAuUmnIaBEph9bpuJkT0YfrIr4YLNezLt4D05X498bv3UvWkP1bpdQIbf2xGXiALM89TsqSOMsgV8mG7uIwtnA1zdWE+CZHDNkMbq9W3hDUYwHv9JeaXsffnmLz7teaCWgwDtL1nVVl6aKd5J0vEAM/B4f2ZtEYhPfQJ5jjZFwRG27+IhPf5Ese8092G9Mqsv/uHJyfbXsg6XSDpKzZovUkI7+h2T20JLeGapjZemILW2DwRknGDUIwzA8hj4qyevXHUmHStFZ8ma+JastP5mz+QyPNIB0x1uwcSzb4WAxvm+QXVvkGzrJJXQhpfJOY/pqWrZMw=
  - secure: dqitLaaIHbacx3okZ9fOG/3etluFETubGUNhP0bYc8+9pjVIGVPS7dU1I7kNPVUi+zpTaq8IH5hE/jD0YdqYePsWW6/PM8Ng/pGjlo9bnyw/ygL/SqLqtUnMiOjVOyfQ+qOy5BtNLfUB/QIDvoSaOSrepix+idS0qjAVsj1qQ+JCsiBkdJMteyVJ+0fqLTZi7Ob5xb0tTEwKp41+5J5WOdOx08x2a+0HSDmAIK1GuX9lw7ixFxtA71gZ5C013hU/YIFHu/J7SKBBNbBk6KEa1xb1LOQFzQBB8ANWKOzOBpVZiZzb/beaFqiysCgx5eu5/zJyG6Xz022JtWF6SJhha56G9DN2C1I1fhhFwSFUdGr+NCS5U/7IpSoVMqQm/ZPKpJgXbuR6P0DGPAcJZukoMXFdA4yaSZpy36tQ/TekOknG6vPgphwzlZGnmdK6QoeiJ1aCd/cFbyk7y8DuwvqUGp8rIyKX4RBJU/x39BNqONaT70gXQrWR5RJkn7v+iJSz3Dj0CpbWavCX0I9ThjHWhhlJgv45WgKmEVJD7V6FcwvG+GKHTVa66GwDSmZ43pKCgcbBofkfZUbea3rZrylcHERV48DUXvb+Rs2JoDAMUEZOrEFznvNhreazEvZ4OX5HT53quwvQ6/mP8BioxFyLwKyt3IO56Ccrqaw3c1itP7Q=
global:
- APP_NAME="MeiQianZheng"
- 'DEVELOPER_NAME="iPhone Distribution: Chunhua Xu(C64LJ4RZPN)"'
- PROFILE_NAME="MeiQianZheng"

